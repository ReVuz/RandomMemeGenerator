<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Random Memes</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      :root {
        --container-width: min(90%, 500px);
        --meme-container-width: min(90%, 800px);
        --padding-large: clamp(20px, 5vw, 40px);
        --padding-medium: clamp(15px, 3vw, 30px);
        --font-size-h1: clamp(1.5rem, 5vw, 2.5rem);
        --font-size-regular: clamp(0.9rem, 2vw, 1.2rem);
      }

      body {
        font-family: "Poppins", sans-serif;
        color: white;
        overflow-x: hidden;
        position: relative;
        background: #0a0a0a;
        min-height: 100vh;
        min-height: 100dvh;
      }

      .nebula-background {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 0;
        overflow: hidden;
      }

      .nebula {
        position: absolute;
        border-radius: 50%;
        filter: blur(60px);
        opacity: 0.3;
        mix-blend-mode: screen;
      }

      .stars {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        background: radial-gradient(
            2px 2px at 40px 60px,
            #fff,
            rgba(0, 0, 0, 0)
          ),
          radial-gradient(2px 2px at 20px 50px, #fff, rgba(0, 0, 0, 0)),
          radial-gradient(2px 2px at 30px 100px, #fff, rgba(0, 0, 0, 0));
        background-repeat: repeat;
        background-size: 200px 200px;
        animation: twinkle 4s ease-in-out infinite;
        opacity: 0.5;
        z-index: 1;
      }

      @keyframes twinkle {
        0%,
        100% {
          opacity: 0.5;
        }
        50% {
          opacity: 0.8;
        }
      }

      .page {
        min-height: 100vh;
        min-height: 100dvh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: var(--padding-large);
        position: relative;
        z-index: 2;
        transition: transform 0.5s ease-in-out;
      }

      #generatorPage {
        transform: translateX(0);
      }

      #memePage {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        transform: translateX(100%);
      }

      .container {
        background: rgba(255, 255, 255, 0.05);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: var(--padding-large);
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        border: 1px solid rgba(255, 255, 255, 0.18);
        width: var(--container-width);
        text-align: center;
      }

      h1 {
        margin-bottom: var(--padding-medium);
        font-size: var(--font-size-h1);
        font-weight: 600;
        text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        opacity: 0;
        line-height: 1.2;
      }

      input[type="text"] {
        padding: var(--padding-medium);
        width: 100%;
        border: none;
        border-radius: 10px;
        font-size: var(--font-size-regular);
        margin-bottom: var(--padding-medium);
        background: rgba(255, 255, 255, 0.1);
        color: white;
        transition: all 0.3s ease;
        opacity: 0;
      }

      input[type="text"]::placeholder {
        color: rgba(255, 255, 255, 0.7);
      }

      input[type="text"]:focus {
        outline: none;
        background: rgba(255, 255, 255, 0.2);
        box-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
      }

      button {
        padding: var(--padding-medium);
        background: linear-gradient(45deg, #7928ca, #ff0080);
        color: white;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        font-size: var(--font-size-regular);
        transition: all 0.3s ease;
        opacity: 0;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        width: 100%;
        max-width: 200px;
      }

      @media (hover: hover) {
        button:hover {
          transform: translateY(-2px);
          box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
      }

      #memeContainer {
        width: var(--meme-container-width);
        margin: 0 auto;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      #expandedMeme {
        width: 100%;
        height: auto;
        border-radius: 15px;
        box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
      }

      #backButton {
        position: fixed;
        top: var(--padding-medium);
        left: var(--padding-medium);
        background: rgba(255, 255, 255, 0.1);
        border: none;
        color: white;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        transition: all 0.3s ease;
        z-index: 10;
        max-width: none;
        width: auto;
      }

      @media (hover: hover) {
        #backButton:hover {
          background: rgba(255, 255, 255, 0.2);
        }
      }

      /* Responsive adjustments */
      @media (max-height: 600px) {
        .page {
          padding: var(--padding-medium);
        }

        .container {
          padding: var(--padding-medium);
        }
      }

      @media (max-width: 380px) {
        input[type="text"] {
          font-size: 16px; /* Prevents zoom on iOS */
        }
      }

      /* Loading indicator */
      .loading-indicator {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 1000;
      }

      .loading-indicator::after {
        content: "";
        display: block;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 3px solid #fff;
        border-color: #fff transparent #fff transparent;
        animation: loader 1.2s linear infinite;
      }

      @keyframes loader {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>
  <body>
    <div class="nebula-background"></div>
    <div class="stars"></div>
    <div class="loading-indicator" id="loadingIndicator"></div>

    <div id="generatorPage" class="page">
      <div class="container">
        <h1>Random Memes</h1>
        <input type="text" id="name" placeholder="Enter your name" />
        <button onclick="generateMeme()">Generate Meme</button>
      </div>
    </div>

    <div id="memePage" class="page">
      <button id="backButton" onclick="goBack()">‚Üê Back</button>
      <div id="memeContainer">
        <img id="expandedMeme" src="" alt="Generated Meme" />
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/gsap.min.js"></script>
    <script>
      const memes = [
        "https://u.cubeupload.com/flashscrap/salimkumar.gif",
        "https://media.tenor.com/c01aviy9onUAAAAM/dance-gif.gif",
        "https://media.tenor.com/LTfU2sOWou4AAAAM/sarkasam-sarcasm.gif",
        "https://media.tenor.com/0rnHDZgsokMAAAAM/dance-suresh-gopi.gif",
      ];

      let isGenerating = false;

      function createNebula() {
        const background = document.querySelector(".nebula-background");
        const colors = ["#7928ca", "#ff0080", "#0070f3", "#00dfd8"];
        const nebulaCount = window.innerWidth < 600 ? 4 : 6;

        for (let i = 0; i < nebulaCount; i++) {
          const nebula = document.createElement("div");
          nebula.className = "nebula";

          const size = Math.random() * 300 + 100;
          nebula.style.width = `${size}px`;
          nebula.style.height = `${size}px`;
          nebula.style.background =
            colors[Math.floor(Math.random() * colors.length)];

          gsap.set(nebula, {
            x: Math.random() * window.innerWidth,
            y: Math.random() * window.innerHeight,
          });

          background.appendChild(nebula);
          animateNebula(nebula);
        }
      }

      function animateNebula(element) {
        gsap.to(element, {
          x: `+=${Math.random() * 200 - 100}`,
          y: `+=${Math.random() * 200 - 100}`,
          scale: Math.random() * 0.5 + 0.5,
          duration: Math.random() * 10 + 10,
          ease: "sine.inOut",
          onComplete: () => animateNebula(element),
        });
      }

      function hashNameToMemeIndex(name) {
        let hash = 0;
        for (let i = 0; i < name.length; i++) {
          hash = (hash + name.charCodeAt(i) * i) % memes.length;
        }
        return hash;
      }

      async function generateMeme() {
        if (isGenerating) return;

        const name = document.getElementById("name").value.trim().toLowerCase();
        if (name === "") {
          gsap.to("input", {
            x: [-10, 10, -10, 10, 0],
            duration: 0.4,
            ease: "power2.inOut",
          });
          return;
        }

        isGenerating = true;
        document.getElementById("loadingIndicator").style.display = "block";

        let nameMemeMap = JSON.parse(localStorage.getItem("nameMemeMap")) || {};
        let memeUrl = nameMemeMap[name] || memes[hashNameToMemeIndex(name)];

        if (!nameMemeMap[name]) {
          nameMemeMap[name] = memeUrl;
          localStorage.setItem("nameMemeMap", JSON.stringify(nameMemeMap));
        }

        const expandedMeme = document.getElementById("expandedMeme");

        // Preload image
        await new Promise((resolve, reject) => {
          const img = new Image();
          img.onload = resolve;
          img.onerror = reject;
          img.src = memeUrl;
        }).catch((error) => console.error("Error loading image:", error));

        expandedMeme.src = memeUrl;
        document.getElementById("loadingIndicator").style.display = "none";
        isGenerating = false;

        showMemePage();
      }

      function showMemePage() {
        gsap.to("#generatorPage", {
          xPercent: -100,
          duration: 0.5,
          ease: "power2.inOut",
        });

        gsap.to("#memePage", {
          xPercent: -100,
          duration: 0.5,
          ease: "power2.inOut",
        });
      }

      function goBack() {
        gsap.to("#generatorPage", {
          xPercent: 0,
          duration: 0.5,
          ease: "power2.inOut",
        });

        gsap.to("#memePage", {
          xPercent: 0,
          duration: 0.5,
          ease: "power2.inOut",
        });
      }

      // Initialize animations
      document.addEventListener("DOMContentLoaded", () => {
        createNebula();

        gsap.to(".container", {
          opacity: 1,
          y: 0,
          duration: 1.5,
          ease: "power2.out",
        });

        gsap.to("h1", {
          opacity: 1,
          duration: 1,
          delay: 0.5,
        });

        gsap.to("input", {
          opacity: 1,
          y: 0,
          duration: 1,
          delay: 1,
        });

        gsap.to("button", {
          opacity: 1,
          y: 0,
          duration: 1,
          delay: 1.2,
        });
      });

      // Handle viewport height on mobile
      function updateVH() {
        let vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty("--vh", `${vh}px`);
      }

      window.addEventListener("resize", updateVH);
      updateVH();
    </script>
  </body>
</html>
